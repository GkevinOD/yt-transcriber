<!DOCTYPE html>

<head>
    <title>Youtube Transcriber</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />
    <link
        rel="stylesheet"
        href="{{ url_for('static',filename='css/styles.css') }}"
    />
    <script
        src="{{ url_for('static',filename='js/script.js') }}"
        defer
    ></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"
        integrity="sha512-q/dWJ3kcmjBLU4Qc47E4A9kTB4m3wuTY7vkFJDTZKjTs8jhyGQnaUrxa0Ytd0ssMZhbNua9hE+E7Qv1j+DyZwA=="
        crossorigin="anonymous"
    ></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jscolor/2.5.1/jscolor.min.js"></script>
    <script>
        jscolor.presets.default = { format: "rgba", previewSize: 30 };
    </script>
</head>

<body>
    <header>
        <div class="header-container">
            <button id="color-scheme">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                        fill-rule="evenodd"
                        clip-rule="evenodd"
                        d="M12.2256 2.00253C9.59172 1.94346 6.93894 2.9189 4.92893 4.92891C1.02369
					8.83415 1.02369 15.1658 4.92893 19.071C8.83418 22.9763 15.1658 22.9763
					19.0711 19.071C21.0811 17.061 22.0565 14.4082 21.9975 11.7743C21.9796 10.9772
					21.8669 10.1818 21.6595 9.40643C21.0933 9.9488 20.5078 10.4276 19.9163
					10.8425C18.5649 11.7906 17.1826 12.4053 15.9301 12.6837C14.0241 13.1072 12.7156
					12.7156 12 12C11.2844 11.2844 10.8928 9.97588 11.3163 8.0699C11.5947 6.81738
					12.2094 5.43511 13.1575 4.08368C13.5724 3.49221 14.0512 2.90664 14.5935
					2.34046C13.8182 2.13305 13.0228 2.02041 12.2256 2.00253ZM17.6569 17.6568C18.9081
					16.4056 19.6582 14.8431 19.9072 13.2186C16.3611 15.2643 12.638 15.4664 10.5858
					13.4142C8.53361 11.362 8.73568 7.63895 10.7814 4.09281C9.1569 4.34184 7.59434
					5.09193 6.34315 6.34313C3.21895 9.46732 3.21895 14.5326 6.34315 17.6568C9.46734
					20.781 14.5327 20.781 17.6569 17.6568Z"
                    />
                </svg>
            </button>

            <div class="search-container">
                <input id="link" placeholder="Youtube link..." />
                <button id="submit-link" type="submit">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path
                            fill-rule="evenodd"
                            clip-rule="evenodd"
                            d="M18.319 14.4326C20.7628 11.2941 20.542 6.75347 17.6569 3.86829C14.5327
						0.744098 9.46734 0.744098 6.34315 3.86829C3.21895 6.99249 3.21895 12.0578
						6.34315 15.182C9.22833 18.0672 13.769 18.2879 16.9075 15.8442C16.921 15.8595
						16.9351 15.8745 16.9497 15.8891L21.1924 20.1317C21.5829 20.5223 22.2161
						20.5223 22.6066 20.1317C22.9971 19.7412 22.9971 19.1081 22.6066 18.7175L18.364
						14.4749C18.3493 14.4603 18.3343 14.4462 18.319 14.4326ZM16.2426 5.28251C18.5858
						7.62565 18.5858 11.4246 16.2426 13.7678C13.8995 16.1109 10.1005 16.1109 7.75736
						13.7678C5.41421 11.4246 5.41421 7.62565 7.75736 5.28251C10.1005 2.93936 13.8995
						2.93936 16.2426 5.28251Z"
                        />
                    </svg>
                </button>
            </div>

            <button id="settings" class="toggle">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                    <path
                        fill-rule="evenodd"
                        clip-rule="evenodd"
                        d="M7 3C8.86384 3 10.4299 4.27477 10.874 6H19V8H10.874C10.4299 9.72523 8.86384 11 7
					11C4.79086 11 3 9.20914 3 7C3 4.79086 4.79086 3 7 3ZM7 9C8.10457 9 9 8.10457 9 7C9
					5.89543 8.10457 5 7 5C5.89543 5 5 5.89543 5 7C5 8.10457 5.89543 9 7 9Z"
                    />
                    <path
                        fill-rule="evenodd"
                        clip-rule="evenodd"
                        d="M17 20C15.1362 20 13.5701 18.7252 13.126 17H5V15H13.126C13.5701 13.2748 15.1362
					12 17 12C19.2091 12 21 13.7909 21 16C21 18.2091 19.2091 20 17 20ZM17 18C18.1046 18
					19 17.1046 19 16C19 14.8954 18.1046 14 17 14C15.8954 14 15 14.8954 15 16C15 17.1046
					15.8954 18 17 18Z"
                    />
                </svg>
                <span>Settings</span>
            </button>
        </div>
    </header>

    <div id="main-settings" class="settings-container hidden">
		<div class="settings-inner-container">
			<div class="settings-section">
				<span class="settings-section-title">App</span>
				<div class="settings-item">
					<label for="settings-key">API Key</label>
					<input text="settings-key" placeholder="Key for applying changes..."/>
				</div>
			</div>

			<div class="settings-section">
				<span class="settings-section-title">Whisper</span>
				<div class="settings-item">
					<label for="settings-language">Language</label>
					<select id="settings-language" class="select-setting" type="text" entries="Auto|English|Japanese" default="English"></select>
				</div>
				<div class="settings-item">
					<label for="settings-model">Model Size (model restarts)</label>
					<select id="settings-model" class="select-setting" type="text" entries="tiny|tiny.en|base|base.en|small|small.en|medium|medium.en|large-v1|large-v2" default="medium"></select>
				</div>
				<div class="settings-item">
					<label for="settings-task">Task</label>
					<select id="settings-task" class="select-setting" type="text" entries="Transcribe|Translate|Both" default="Transcribe"></select>
				</div>
				<div class="settings-item">
					<label for="settings-interval">Interval (seconds)</label>
					<select id="settings-interval" class="select-setting" type="number" tofixed="1" min="1" max="15" step="0.1" default="5.0"></select>
				</div>
				<div class="settings-item">
					<label for="settings-buffer">Max Buffer</label>
					<select id="settings-buffer" class="select-setting" type="number" tofixed="0" min="0" max="15" step="1" default="5"></select>
				</div>
				<div class="settings-item">
					<label for="settings-prompt-history">Prompt Buffer (seconds)</label>
					<select id="settings-prompt-history" class="select-setting" type="number" tofixed="0" min="0" max="120" step="1" default="30"></select>
				</div>
				<div class="settings-item">
					<label for="settings-prompt-max-gap">Prompt Max Gap (seconds)</label>
					<select id="settings-prompt-max-gap" class="select-setting" type="number" tofixed="0" min="1" max="30" step="1" default="5"></select>
				</div>
				<div class="settings-item">
					<label for="settings-temperature">Max Temperature</label>
					<select id="settings-temperature" class="select-setting" type="number" tofixed="2" min="0" max="1" step="0.01" default="0.00"></select>
				</div>
				<div class="settings-item">
					<label for="settings-temperature-fallback">Temperature Fallback</label>
					<select id="settings-temperature-fallback" class="select-setting" type="number" tofixed="3" min="0" max="0.5" step="0.025" default="0.200"></select>
				</div>
				<div class="settings-item">
					<label for="settings-beam-size">Beam Size</label>
					<select id="settings-beam-size" class="select-setting" type="number" tofixed="0" min="0" max="20" step="1" default="3"></select>
				</div>
				<div class="settings-item">
					<label for="settings-best-of">Best Of</label>
					<select id="settings-best-of" class="select-setting" type="number" tofixed="0" min="0" max="20" step="1" default="3"></select>
				</div>
			</div>

			<div class="settings-section">
				<span class="settings-section-title">Silero VAD</span>
				<div class="settings-item">
					<label for="settings-use-vad">Use Vad (session restarts)</label>
					<select id="settings-use-vad" class="select-setting" type="text" entries="Enabled|Disabled" default="Enabled"></select>
				</div>
				<div class="settings-item">
					<label for="settings-threshold-low">Threshold Low</label>
					<select id="settings-threshold-low" class="select-setting" type="number" tofixed="2" min="0" max="1" step="0.01" default="0.10"></select>
				</div>
				<div class="settings-item">
					<label for="settings-threshold-high">Threshold High</label>
					<select id="settings-threshold-high" class="select-setting" type="number" tofixed="2" min="0" max="1" step="0.01" default="0.40"></select>
				</div>
				<div class="settings-item">
					<label for="settings-sample-size">Chunk Size (ms)</label>
					<select id="settings-sample-size" class="select-setting" type="number" tofixed="0" min="256" max="2048" step="32" default="256"></select>
				</div>
				<div class="settings-item">
					<label for="settings-sample-size">Sample Size (ms) (session restarts)</label>
					<select id="settings-sample-size" class="select-setting" type="number" tofixed="0" min="32" max="96" step="32" default="32"></select>
				</div>
			</div>

			<div class="settings-section">
				<span class="settings-section-title">Processing</span>
				<div class="settings-item">
					<label for="settings-prepend">Prepend Audio (ms)</label>
					<select id="settings-prepend" class="select-setting" type="number" tofixed="0" min="0" max="2048" step="32" default="512"></select>
				</div>
				<div class="settings-item">
					<label for="settings-append">Append Audio (ms)</label>
					<select id="settings-append" class="select-setting" type="number" tofixed="0" min="0" max="2048" step="32" default="512"></select>
				</div>
				<div class="settings-item">
					<label for="settings-min-speech">Speech Ratio</label>
					<select id="settings-min-speech" class="select-setting" type="number" tofixed="2" min="0" max="1" step="0.01" default="0.30"></select>
				</div>
				<div class="settings-item">
					<label for="settings-max-silent">Max Silent (ms)</label>
					<select id="settings-max-silent" class="select-setting" type="number" tofixed="0" min="0" max="5024" step="32" default="96"></select>
				</div>
			</div>
		</div>
		<script>
			document.querySelectorAll('select.select-setting[type="text"]').forEach(element =>
				element.getAttribute('entries').split('|').forEach(entry => {
					element.innerHTML += `<option value="${entry}" ${entry == element.getAttribute('default') ? 'selected' : ''}>${entry}</option>`;
			}));

			document.querySelectorAll('select.select-setting[type="number"]').forEach(element => {
					for(let i = parseFloat(element.getAttribute('min')); i <= parseFloat(element.getAttribute('max')); i += parseFloat(element.getAttribute('step'))) {
						i_str = i.toFixed(parseInt(element.getAttribute('tofixed')));
						element.innerHTML += `<option value="${i_str}"${i_str == element.getAttribute('default') ? 'selected' : ''}>${i_str}</option>`;
					}
			});
		</script>

		<button id="settings-apply">
			<span>Apply Settings</span>
		</button>
	</div>

    <div class="main-container">
        <div class="video-container">
            <div id="player-container">
                <div id="transcribe" class="subtitle-wrapper"></div>
                <button id="fullscreen">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M3 3H9V5H5V9H3V3Z" />
                        <path d="M3 21H9V19H5V15H3V21Z" />
                        <path d="M15 21H21V15H19V19H15V21Z" />
                        <path d="M21 3H15V5H19V9H21V3Z" />
                    </svg>
                </button>
                <div id="player"></div>
            </div>

            <div class="controller-container">
                <div class="subtitle-settings">
                    <div class="subtitle-options">
                        <label for="font-size">Font Size:</label>
                        <input type="number" id="font-size" min="10" max="36" value="20"/>
                        <label for="font-color">Font Color:</label>
                        <button
                            id="font-color"
                            class="color-selector"
                            data-jscolor="{onChange: 'setFontColor(this)', alpha:1, value:'FFFFFF'}"
                        ></button>
                        <label for="font-family">Font Family:</label>
                        <select id="font-family">
                            <option value="Arial">Arial</option>
                            <option value="Verdana">Verdana</option>
                            <option value="Times New Roman">Times New Roman </option>
                            <option value="Courier New">Courier New</option>
                            <option value="Georgia">Georgia</option>
                            <option value="Trebuchet MS">Trebuchet MS</option>
                            <option value="Tahoma">Tahoma</option>
                            <option value="Impact">Impact</option>
                            <option value="Lucida Console">Lucida Console </option>
                            <option value="Lucida Sans Unicode">Lucida Sans Unicode</option>
                        </select>
                        <label for="background-color">Background Color:</label>
                        <button
                            id="background-color"
                            class="color-selector"
                            data-jscolor="{ onChange: 'setBackgroundColor(this)', alpha:0.5, value:'000000'}"
                        ></button>
                    </div>
                </div>
            </div>
        </div>

        <div class="transcript-container">
			<div class="table-container">
				<table class="transcript-table">
				</table>
			</div>
        </div>
    </div>
</body>
